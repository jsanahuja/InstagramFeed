function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _iterableToArrayLimit(a,b){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function _arrayWithHoles(a){if(Array.isArray(a))return a}function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}(function(a,b){"function"==typeof define&&define.amd?define([],b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=b():a.InstagramFeed=b()})(this,function(){function a(a){return a.replace(/[&<>"'`=\/]/g,function(a){return d[a]})}var b={host:"https://www.instagram.com/",username:"",tag:"",container:"",display_profile:!0,display_biography:!0,display_gallery:!0,display_captions:!1,caption_styles:{"font-size":"0.8rem",color:"black","background-color":"hsla(0, 100%, 100%, 0.8)","text-align":"center",padding:"1%","overflow-y":"auto","overflow-x":"hidden",position:"absolute",left:"0",right:"0",bottom:"0","max-height":"100%",content:"attr(data-caption)"},display_igtv:!1,callback:null,styling:!0,items:8,items_per_row:4,margin:.5,image_size:640,lazy_load:!1,on_error:console.error,cache_prefix:"igf_",cache_for:"30:min",cache_use:!1},c={150:0,240:1,320:2,480:3,640:4},d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return function(d){this.options=Object.assign({},b),this.options=Object.assign(this.options,d),d.caption_styles&&(this.options.caption_styles=Object.assign({},b.caption_styles),this.options.caption_styles=Object.assign(this.options.caption_styles,d.caption_styles)),this.is_tag=""==this.options.username,this.valid=!0,""==this.options.username&&""==this.options.tag&&(this.options.on_error("InstagramFeed: Error, no username or tag defined.",1),this.valid=!1),"undefined"!=typeof this.options.get_data&&console.warn("InstagramFeed: options.get_data is deprecated, options.callback is always called if defined"),null==this.options.callback&&""==this.options.container&&(this.options.on_error("InstagramFeed: Error, neither container found nor callback defined.",2),this.valid=!1),this.url=function(){return this.is_tag?this.options.host+"explore/tags/"+this.options.tag+"/":this.options.host+this.options.username+"/"},this.get=function(a){var b=this.url(),c=new XMLHttpRequest,d=this,e=d.is_tag?"t-"+d.options.tag:"u-"+d.options.username,f=!0===d.options.cache_use?d.cache(e):null;null===f?(c.onload=function(){if(4===c.readyState)if(200===c.status){try{f=c.responseText.split("window._sharedData = ")[1].split("</script>")[0]}catch(a){return void d.options.on_error("InstagramFeed: It looks like the profile you are trying to fetch is age restricted. See https://github.com/jsanahuja/InstagramFeed/issues/26",3)}if(f=JSON.parse(f.substr(0,f.length-1)),f=f.entry_data.ProfilePage||f.entry_data.TagPage,"undefined"==typeof f)return void d.options.on_error("InstagramFeed: It looks like YOUR network has been temporary banned because of too many requests. See https://github.com/jsanahuja/jquery.instagramFeed/issues/25",4);f=f[0].graphql.user||f[0].graphql.hashtag,d.cache(e,f),a(f,d)}else d.options.on_error("InstagramFeed: Unable to fetch the given user/tag. Instagram responded with the status code: "+c.statusText,5)},c.open("GET",b,!0),c.send()):a(f,d)},this.cache_expire=function(a){var b=new Date,c=new Date(b),d=a.split(":"),e=1;if(1<d.length)switch(e=parseInt(d[0],10),type=d[1],type){case"min":case"minute":case"minutes":c.setMinutes(b.getMinutes()+e);break;case"mon":case"month":case"months":c.setMonth(b.getMonth()+e);break;case"hour":case"hours":default:c.setHours(b.getHours()+e);}var f=c.getTime();return f},this.cache_keys=function(a){for(var b=[],c=Object.keys(a),d=c.length,e=new RegExp("/^"+prefix+"/");d--;){var f=c[d];f.match(e)&&b.push(f)}return b},this.cache=function(a,b){var c=this,d=null,e=c.options.cache_prefix,f=c.options.cache_for,g=window.localStorage;if(g)switch(null!==a&&(a=e+a),b){case"REMOVE":"string"==typeof a&&g.removeItem(a);break;default:if(null===a){var h=c.cache_keys(g);0<h.length&&h.forEach(function(a){a=a.replace(e,""),c.cache(a,"REMOVE")})}else if(b||!1===b){var i=c.cache_expire(f),j={v:b,m:{on:Date.now(),e:i}};j=JSON.stringify(j);try{g.setItem(a,j)}catch(a){var k=["InstagramFeed: Unable to cache the instagram feed for:",this.url(),"because a window.localStorage storage exception occurred:",a.toString()].join(" ");c.options.on_error(k)}}else if(d=g.getItem(a),null!==d){d=JSON.parse(d);var l=d.m.e,m=Date.now();d=m<l?d.v:null}}return d},this.parse_caption=function(a,b){return"undefined"!=typeof a.node.edge_media_to_caption.edges[0]&&"undefined"!=typeof a.node.edge_media_to_caption.edges[0].node&&"undefined"!=typeof a.node.edge_media_to_caption.edges[0].node.text&&null!==a.node.edge_media_to_caption.edges[0].node.text?a.node.edge_media_to_caption.edges[0].node.text:"undefined"!=typeof a.node.title&&null!==a.node.title&&0!=a.node.title.length?a.node.title:"undefined"!=typeof a.node.accessibility_caption&&null!==a.node.accessibility_caption&&0!=a.node.accessibility_caption.length?a.node.accessibility_caption:(this.is_tag?b.name:b.username)+" image "},this.caption_style=function(){var a=this.options.caption_styles,b="";if("object"===_typeof(a))for(var c=0,d=Object.entries(a);c<d.length;c++){var e=_slicedToArray(d[c],2),f=e[0],g=e[1];if(null!==g){var h=new String(g);b+=f+":"+h+";"}}else null!==a&&(b=new String(a));return b},this.display=function(b){var d,e="";if(this.options.styling){var f=(100-2*this.options.margin*this.options.items_per_row)/this.options.items_per_row;if(d={profile_container:" style='text-align:center;'",profile_image:" style='border-radius:10em;width:15%;max-width:125px;min-width:50px;'",profile_name:" style='font-size:1.2em;'",profile_biography:" style='font-size:1em;'",gallery_image:" style='width:100%;'",gallery_image_link:" style='width:"+f+"%; margin:"+this.options.margin+"%; position:relative; display: inline-block; height: 100%;'"},this.options.display_captions){var g=this.caption_style();e+="<style> a[data-caption]:hover::after { "+g+" } </style>"}}else d={profile_container:"",profile_image:"",profile_name:"",profile_biography:"",gallery_image:"",gallery_image_link:""};if(this.options.display_profile&&(e+="<div class='instagram_profile'"+d.profile_container+">",e+="<img class='instagram_profile_image'"+(this.options.lazy_load?" loading='lazy'":"")+" src='"+b.profile_pic_url+"' alt='"+(this.is_tag?b.name+" tag pic":b.username+" profile pic")+" profile pic'"+d.profile_image+" />",e+=this.is_tag?"<p class='instagram_tag'"+d.profile_name+"><a href='https://www.instagram.com/explore/tags/"+this.options.tag+"' rel='noopener' target='_blank'>#"+this.options.tag+"</a></p>":"<p class='instagram_username'"+d.profile_name+">@"+b.full_name+" (<a href='https://www.instagram.com/"+this.options.username+"' rel='noopener' target='_blank'>@"+this.options.username+"</a>)</p>",!this.is_tag&&this.options.display_biography&&(e+="<p class='instagram_biography'"+d.profile_biography+">"+b.biography+"</p>"),e+="</div>"),this.options.display_gallery){var h="undefined"==typeof c[this.options.image_size]?c[640]:c[this.options.image_size];if("undefined"!=typeof b.is_private&&!0===b.is_private)e+="<p class='instagram_private'><strong>This profile is private</strong></p>";else{var j=(b.edge_owner_to_timeline_media||b.edge_hashtag_to_media).edges;q=j.length>this.options.items?this.options.items:j.length,e+="<div class='instagram_gallery'>";for(var k=0;k<q;k++){var l,m,n="https://www.instagram.com/p/"+j[k].node.shortcode,o=a(this.parse_caption(j[k],b));switch(j[k].node.__typename){case"GraphSidecar":m="sidecar",l=j[k].node.thumbnail_resources[h].src;break;case"GraphVideo":m="video",l=j[k].node.thumbnail_src;break;default:m="image",l=j[k].node.thumbnail_resources[h].src;}this.is_tag&&(b.username=""),e+="<a href='"+n+(this.options.display_captions?"' data-caption='"+o:"")+"' class='instagram-"+m+"' rel='noopener' target='_blank'"+d.gallery_image_link+">",e+="<img"+(this.options.lazy_load?" loading='lazy'":"")+" src='"+l+"' alt='"+o+"'"+d.gallery_image+" />",e+="</a>"}e+="</div>"}}if(this.options.display_igtv&&"undefined"!=typeof b.edge_felix_video_timeline){var p=b.edge_felix_video_timeline.edges,q=p.length>this.options.items?this.options.items:p.length;if(0<p.length){e+="<div class='instagram_igtv'>";for(var k=0;k<q;k++){var n="https://www.instagram.com/p/"+p[k].node.shortcode,o=a(this.parse_caption(p[k],b));e+="<a href='"+n+(this.options.display_captions?"' data-caption='"+o:"")+"' rel='noopener' target='_blank'"+d.gallery_image_link+">",e+="<img"+(this.options.lazy_load?" loading='lazy'":"")+" src='"+p[k].node.thumbnail_src+"' alt='"+o+"'"+d.gallery_image+" />",e+="</a>"}e+="</div>"}}this.options.container.innerHTML=e},this.run=function(){this.get(function(a,b){""!=b.options.container&&b.display(a),"function"==typeof b.options.callback&&b.options.callback(a)})},this.valid&&this.run()}});
